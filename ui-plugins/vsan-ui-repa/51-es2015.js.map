{"version":3,"sources":["./src/app/vsan/common/component/chart/pie-chart/pie-chart.html","./src/app/vsan/common/component/chart/pie-chart/pie-chart.component.ts"],"names":[],"mappings":"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","file":"51-es2015.js","sourcesContent":["<!--Copyright 2018-2021 VMware, Inc. All rights reserved. -- VMware Confidential-->\n<div class=\"pie-chart-container\">\n   <div #pieChart class=\"pie-chart\"></div>\n   <div class=\"total-section\"\n        tabindex=\"0\"\n        *ngIf=\"showTotal\"\n        [ngClass]=\"{'clickable-middle': hasTotalClickSubscribers}\"\n        (keyup.enter)=\"onTotalClick($event)\"\n        (click)=\"onTotalClick($event)\">\n      <div>{{totalLabel}}</div>\n      <div>{{sectionsTotal}}</div>\n   </div>\n</div>","/* Copyright 2018-2021 VMware, Inc. All rights reserved. -- VMware Confidential */\nimport {\n   AfterViewInit,\n   ChangeDetectorRef,\n   Component,\n   ElementRef,\n   EventEmitter,\n   Input,\n   Output,\n   ViewChild,\n} from \"@angular/core\";\nimport {VsanUiUtils} from \"@util/vsan-util\";\nimport {ChartSectionData} from \"../model/chart-section.data\";\nimport {HighchartsPropertiesService} from \"../highcharts-properties.service\";\nimport {HighchartsThemeService} from \"../highcharts-theme.service\";\nimport * as Highcharts from \"highcharts\";\nimport {ReferenceWatcher} from \"@util/reference-watcher\";\n\n/**\n * Displays a pie chart based on Highcharts pie chart.\n */\n@Component({\n   selector: \"vsan-pie-chart\",\n   templateUrl: \"pie-chart.html\",\n   styleUrls: [\"pie-chart.scss\"],\n   providers: [ReferenceWatcher],\n})\nexport class PieChartComponent implements AfterViewInit {\n   highchartOptions: any;\n\n   /**\n    * Sections with value/label data to be displayed in the pie chart\n    */\n   @Input()\n   sections: ChartSectionData[];\n\n   /**\n    * The size of the inner diameter for the pie. A size greater than 0 renders a donut chart.\n    * Percentages are relative to the pie size.\n    */\n   @Input()\n   innerSize: string;\n\n   /**\n    * Controls the height of the chart area around the pie.\n    * Default is 400px.\n    */\n   @Input()\n   chartSize: number;\n\n   /**\n    * The angle from which to start the first section in the pie chart. Defaults to 0.\n    */\n   @Input()\n   startAngle: number = 0;\n\n   /**\n    * Whether to display the pie chart labels for the data series.\n    * Defaults to true.\n    */\n   @Input()\n   showLabels: boolean = true;\n\n   /**\n    * Whether to include the pie chart labels as part of the tooltips of the series.\n    * Defaults to false, meaning that only the value will be displayed in the tooltip.\n    */\n   @Input()\n   showTooltipLabels: boolean;\n\n   /**\n    * Whether to include a \"Total XX\" label in the middle of the pie-chart.\n    */\n   @Input()\n   showTotal: boolean;\n\n   @Input()\n   totalLabel: string = VsanUiUtils.getString(\"vsan.common.pie.chart.total.label\");\n\n   /**\n    * Whether hovering over the pie chart will show tooltip for the series.\n    */\n   @Input()\n   showTooltips: boolean = true;\n\n   /**\n    * Upon clicking on the chart, emit event containing the id of the ChartSectionData that is clicked.\n    */\n   @Output()\n   selection: EventEmitter<string> = new EventEmitter();\n\n   @Output()\n   totalClick: EventEmitter<void> = new EventEmitter();\n\n   /**\n    * Label containing the total from all sections. Evaluated if showTotal is set to true;\n    */\n   sectionsTotal: string;\n   hasTotalClickSubscribers: boolean;\n\n   @ViewChild(\"pieChart\")\n   chartElement: ElementRef;\n   chart: Highcharts.Chart;\n\n   constructor(private highchartsService: HighchartsPropertiesService,\n         private highchartsThemeService: HighchartsThemeService,\n         private changeDetector: ChangeDetectorRef,\n         private refWatcher: ReferenceWatcher) {\n      // Set the chart options by extending the basic ones with pie chart specific ones.\n      this.applyHighchartOptions();\n      this.refWatcher.watchSubscriptionRef(\n            this.highchartsThemeService.whenThemeChanged.subscribe(theme => this.onThemeChanged()));\n   }\n\n   ngAfterViewInit(): void {\n      this.configureChartOptions();\n      this.render();\n      this.hasTotalClickSubscribers = this.showTotal && this.totalClick.observers.length > 0;\n      this.changeDetector.detectChanges();\n   }\n\n   private configureChartOptions(): void {\n      this.updateChartCustomSettings();\n      this.updateSectionsData();\n   }\n\n   private onThemeChanged(): void {\n      this.applyHighchartOptions();\n      this.configureChartOptions();\n      this.update();\n   }\n\n   private applyHighchartOptions = () => {\n      this.highchartOptions = this.highchartsService.getPieChartOptions((event: any) => this.onChartSelection(event));\n   };\n\n   private updateChartCustomSettings = () => {\n      this.highchartOptions.plotOptions.pie.innerSize = this.innerSize;\n      this.highchartOptions.chart.height = this.chartSize;\n      this.highchartOptions.plotOptions.pie.startAngle = this.startAngle;\n      this.highchartOptions.plotOptions.pie.dataLabels.enabled = this.showLabels;\n      this.highchartOptions.tooltip.enabled = this.showTooltips;\n   };\n\n   private updateSectionsData = () => {\n      if (!this.sections) {\n         return;\n      }\n      const chartData: any[] = [];\n      let total: number = 0;\n      this.sections\n            .filter(section => section.showValue)\n            .forEach((sectionData: ChartSectionData) => {\n         const section: any = {\n            name: sectionData.sectionLabel,\n            id: sectionData.id,\n            y: sectionData.sectionValueInBytes,\n            color: sectionData.customSectionColor,\n            custom: {\n               tooltipValue: sectionData.tooltipValue,\n            },\n         };\n         if (this.showTooltipLabels) {\n            /**\n             * Tooltip will be displayed in format \"label: value\"\n             */\n            section.custom.tooltipValue = new Map<string, string>([\n                  [section.name, VsanUiUtils.formatFileSize(section.y)],\n            ]);\n         }\n         chartData.push(section);\n         total += sectionData.sectionValueInBytes;\n      });\n      const series: any[] = [{\n         name: VsanUiUtils.getString(\"vsan.monitor.capacity.usage.breakdown.category.pie.series.label\"),\n         data: chartData,\n      }];\n\n      if (this.showTotal) {\n         // Update the total label if we are supposed to show it.\n         this.sectionsTotal = VsanUiUtils.formatFileSize(total);\n      }\n\n      this.highchartOptions.series = series;\n      // Avoid \"expression changed after it was checked error\"\n      this.changeDetector.detectChanges();\n   };\n\n   private update(): void {\n      if (this.chart) {\n         this.chart.update(this.highchartOptions);\n      }\n   }\n\n   private render(): void {\n      if (this.chartElement) {\n         this.highchartOptions.chart.renderTo = this.chartElement.nativeElement;\n         this.chart = Highcharts.chart(this.highchartOptions);\n         this.highchartsService.applyScreenReaderMessage(this.chartElement.nativeElement);\n         this.refWatcher.watchChartRef(this.chart);\n      }\n   }\n\n   onChartSelection(event: any): void {\n      if (event.point) {\n         this.selection.emit(event.point.id);\n      } else if (event.target) {\n         this.selection.emit(event.target.id);\n      }\n   }\n\n   onTotalClick(event: any): void {\n      this.totalClick.emit();\n   }\n}\n"],"sourceRoot":"webpack:///"}